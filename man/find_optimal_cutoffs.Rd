% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/optimization.R
\name{find_optimal_cutoffs}
\alias{find_optimal_cutoffs}
\title{Find optimal cutoffs for a credit policy stage}
\usage{
find_optimal_cutoffs(
  data,
  config,
  cutoff_steps = 10,
  target_default_rate = 0.05,
  min_approval_rate = 0.3,
  parallel = FALSE,
  n_cores = NULL
)
}
\arguments{
\item{data}{A data frame containing applicant data.}

\item{config}{A base \code{credit_policy} object. The optimization will add a
\code{stage_cutoff} to this policy for each iteration.}

\item{cutoff_steps}{The number of steps to create for each score's cutoff range.
The range is from the min to the max score in the data.}

\item{target_default_rate}{The maximum acceptable overall default rate for the approved population.}

\item{min_approval_rate}{The minimum acceptable overall approval rate.}

\item{parallel}{A logical flag indicating whether to use parallel processing.
Requires the \code{future} and \code{furrr} packages.}

\item{n_cores}{The number of cores to use for parallel processing. Defaults to
all available cores minus one.}
}
\value{
A data frame with the single best combination of cutoffs found, along
with its performance metrics. The full evaluation results are available in
the \code{evaluation_results} attribute of the returned object.
}
\description{
This function systematically evaluates a grid of cutoff combinations for a set
of scores to find the optimal set of cutoffs that maximizes a trade-off
score while respecting given constraints on default and approval rates.
}
\details{
The optimization works by modifying a base \code{credit_policy} object. For each
combination of cutoffs, it creates a new \code{stage_cutoff} and inserts it as the
first stage of the simulation funnel. It then runs the full multi-stage
simulation and evaluates the final metrics.
}
\examples{
# This is a long-running example, wrapped in \dontrun{} for automated checks.
# For a real use case, you would run this code.
\dontrun{
  # 1. Generate data and define a base policy
  sample_data <- generate_sample_data(n_applicants = 2000, seed = 42)
  base_policy <- credit_policy(
    applicant_id_col = "id",
    score_cols = "new_score",
    current_approval_col = "approved",
    actual_default_col = "defaulted"
  )

  # 2. Find optimal cutoffs
  # This will test 10 different cutoffs for "new_score"
  opt_results <- find_optimal_cutoffs(
    data = sample_data,
    config = base_policy,
    cutoff_steps = 10,
    target_default_rate = 0.15,
    min_approval_rate = 0.20
  )

 # 3. View the single best result
 print(opt_results)

 # 4. Analyze the trade-offs across all tested combinations
 tradeoff_analysis <- analyze_tradeoffs(opt_results)

 # 5. Visualize the Pareto frontier
 visualize_tradeoffs(tradeoff_analysis, type = "pareto")
}
}
